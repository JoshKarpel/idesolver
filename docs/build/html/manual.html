

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Manual &mdash; idesolver 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="idesolver 1.0 documentation" href="index.html"/>
        <link rel="next" title="API" href="api.html"/>
        <link rel="prev" title="Quickstart" href="quickstart.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> idesolver
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-algorithm">The Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stopping-conditions">Stopping Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#global-error-estimate">Global Error Estimate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-suite">Test Suite</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">idesolver</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Manual</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/manual.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="manual">
<h1>Manual<a class="headerlink" href="#manual" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="api.html#idesolver.IDESolver" title="idesolver.IDESolver"><code class="xref py py-class docutils literal"><span class="pre">IDESolver</span></code></a> implements an iterative algorithm from <a class="reference external" href="https://doi.org/10.1016/j.cpc.2013.09.008">this paper</a> for solving general IDEs.
The algorithm requires an ODE integrator and a quadrature integrator internally.
IDESolver uses <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy.integrate.solve_ivp" title="(in SciPy v1.0.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.solve_ivp()</span></code></a> as the ODE integrator.
The quadrature integrator is either <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(in SciPy v1.0.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.quad()</span></code></a> or <a class="reference internal" href="api.html#idesolver.complex_quad" title="idesolver.complex_quad"><code class="xref py py-func docutils literal"><span class="pre">complex_quad()</span></code></a>, a thin wrapper over <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(in SciPy v1.0.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.quad()</span></code></a> which handles splitting the real and imaginary parts of the integral.</p>
<div class="section" id="the-algorithm">
<span id="id1"></span><h2>The Algorithm<a class="headerlink" href="#the-algorithm" title="Permalink to this headline">¶</a></h2>
<p>We want to find an approximate solution to</p>
<div class="math">
\[\begin{split}\frac{dy}{dx} &amp; = c(y, x) + d(x) \int_{\alpha(x)}^{\beta(x)} k(x, s) \, F( y(s) ) \, ds, \\
&amp; x \in [a, b], \quad y(a) = y_0.\end{split}\]</div>
<p>The algorithm begins by creating an initial guess for <span class="math">\(y\)</span> by using an ODE solver on</p>
<div class="math">
\[\frac{dy}{dx} = c(y, x)\]</div>
<p>Since there’s no integral on the right-hand-side, standard ODE solvers can handle it easily.
Call this guess <span class="math">\(y^{(0)}\)</span>.
We can then produce a better guess by seeing what we would get with the original IDE, but replacing <span class="math">\(y\)</span> on the right-hand-side by <span class="math">\(y^{(0)}\)</span>:</p>
<div class="math">
\[\frac{dy^{(1/2)}}{dx} = c(y^{(0)}, x) + d(x) \int_{\alpha(x)}^{\beta(x)} k(x, s) \, F( y^{(0)}(s) ) \, ds\]</div>
<p>Again, this is just an ODE, because <span class="math">\(y^{(1/2)}\)</span> does not appear on the right.
At this point in the algorithm we check the global error between <span class="math">\(y^{(0)}\)</span> and <span class="math">\(y^{(1/2)}\)</span>.
If it’s smaller than the tolerance, we stop iterating and take <span class="math">\(y^{(1/2)}\)</span> to be the solution.
If it’s larger than the tolerance, the iteration continues.
To be conservative and to make sure we don’t over-correct, we’ll combine <span class="math">\(y^{(1/2)}\)</span> with <span class="math">\(y^{(0)}\)</span>.</p>
<div class="math">
\[y^{(1)} = \alpha y^{(0)} + (1 - \alpha) y^{(1/2)}\]</div>
<p>The process then repeats: solve the IDE-turned-ODE with <span class="math">\(y^{(1)}\)</span> on the right-hand-side, see how different it is, maybe make a new guess, etc.</p>
</div>
<div class="section" id="stopping-conditions">
<h2>Stopping Conditions<a class="headerlink" href="#stopping-conditions" title="Permalink to this headline">¶</a></h2>
<p>IDESolver can operate in three modes: either a nonzero global error tolerance should be given, or a maximum number of iterations should be given, or both should be given.
Nonzero global error tolerance is the standard mode, described in <a class="reference internal" href="#the-algorithm"><span class="std std-ref">The Algorithm</span></a>.
If a maximum number of iterations is given with zero global error tolerance, the algorithm will iterate that many times and then stop.
If both are given, the algorithm terminates if either condition is met.</p>
</div>
<div class="section" id="global-error-estimate">
<h2>Global Error Estimate<a class="headerlink" href="#global-error-estimate" title="Permalink to this headline">¶</a></h2>
<p>The default global error estimate <span class="math">\(G\)</span> between two possible solutions <span class="math">\(y_1\)</span> and <span class="math">\(y_2\)</span> is</p>
<div class="math">
\[G = \sqrt{ \sum_{x_i} \left| y_1(x_i) - y_2(x_i) \right| }\]</div>
<p>A different global error estimator can be passed in the constructor as the argument <cite>global_error_function</cite>.</p>
</div>
<div class="section" id="test-suite">
<h2>Test Suite<a class="headerlink" href="#test-suite" title="Permalink to this headline">¶</a></h2>
<p>Running the test suite requires some additional Python packages: <cite>pip install pytest pytest-mock hypothesis</cite>.
You’ll also need to get the entire IDESolver repository via <cite>git clone https://github.com/JoshKarpel/idesolver.git</cite>.
Once installed, you can run the test suite by running <cite>pytest</cite> from the top-level directory of the package.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Joshua T Karpel.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>